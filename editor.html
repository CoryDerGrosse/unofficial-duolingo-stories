<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Duolingo - Unofficial stories</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="js/story.js"></script>

    <link rel="stylesheet" href="css/story.css"></link>

    <script src="https://pagecdn.io/lib/ace/1.4.5/ace.js" integrity="sha256-5Xkhn3k/1rbXB+Q/DX/2RuAtaB4dRRyQvMs83prFjpM=" crossorigin="anonymous"></script>

    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body>
<div style="display: grid; grid-template-columns: auto auto;">
    <div style="width: 50%">
    <div id="editor" contenteditable="" style="width: 50%" >
title=Kamer te huur
language=nl

> Verteller: Aafke huurt dit weekend een kamer bij Lonneke. Ze klopt op de deur.

> Aafke: Hallo, ik ben Aafke.

> Lonneke: Ik ben Lonneke. Kom binnen.

[choice] Aafke is in Lonnekes huis om…/Aafke is at Lonneke’s house to…
+ rent a room for the weekend.
- sell a painting of a room.
- tell Lonneke she had to knock on the door because the doorbell isn’t working.

> Aafke: Oh, dit is een heel mooie kamer!

> Lonneke: Bedankt. Ik verhuur hem vaak.

> Lonneke: Maar goed, dat kan veranderen.
    </div>
    </div>
    <div style="background: white">
    <div id="header" style="display: none">
        <div id="progress"><span id="progress_inside"></span></div>
    </div>
    <div id="main">

        <div id="story">

        </div>
    </div>
    <div id="footer" style="display: none">
        <div id="button_next" class="button" onclick="addNext();">continue</div>
    </div>
    </div>
</div>
<script>
let editorE = document.getElementById("editor");
var editor = ace.edit("editor");
editor.setTheme("ace/theme/monokai");
editor.session.setMode("ace/mode/javascript");
editor.session.setUseWrapMode(true);
editor.resize();

editor.commands.addCommand({
    name: 'compile',
    bindKey: {win: 'Ctrl-Enter',  mac: 'Command-Enter'},
    exec: function(editor) {
        updateStoryDisplay();
    },
    readOnly: true // false if this command should not apply in readOnly mode
});


let story = undefined;
function updateStoryDisplay() {
    story = editor.getValue();
    processStoryFile();
    index = 0;
    d3.select("#story").selectAll("*").remove();
    addTitle();
    while (index < phrases.length) {
        document.getElementById("button_next").dataset.status = "active";
        addNext();
    }
}
updateStoryDisplay();


</script>
</body>
</html>